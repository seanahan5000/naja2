TDELAY          =   $C0
BDELAY          =   $C1

ENROLL_GUARD    JSR DRAW_PICT
                PictSetPage2
                PictClearPage
                PictCall DRAW_HALL
                PictImage GUARD_PIC
                PictShowPage
                PictEnd
:1              BIT UNSTROB
                JSR SCANNER
                LDA #$04
                JSR WAIT
                LDA KEYBRD
                BPL :1
                JSR CHECK_TURN
                BNE :1
                JSR DRAW_PICT
                PictSetPage1
                PictClearPage
                PictShowPage
                PictEnd
                SEC
                RTS

SCANNER         DEC TDELAY
                BPL :1
                DEC TDELAY+1
                BPL :1
                LDA #$80
                STA TDELAY+1
                LDX #0
                LDY #$33
                JSR SCAN
:1              DEC BDELAY
                BPL SCEXIT
                DEC BDELAY+1
                BPL SCEXIT
                LDA #$60
                STA BDELAY+1
                LDX #1
                LDY #$35
                ; fall through

SCAN            STX SELECT
                LDA LOBYTES,Y
                STA SCREENL
                LDA HIBYTES,Y
                STA SCREENH

                LDA CYCLE,X
                ASL
                ASL
                TAX
                LDY #$12
:1              LDA SDATA,X
                STA (SCREENL),Y
                INX
                INY
                CPY #$16
                BNE :1

                LDX SELECT
                LDA CYCLE,X
                BEQ :2
                CMP #$08
                BNE :3
                LDA DIRECT,X
                BNE DOWN
                DEC DIRECT,X
                RTS

:2              LDA DIRECT,X
                BPL UP
                INC DIRECT,X
                RTS

:3              LDA DIRECT,X
                BMI DOWN
UP              INC CYCLE,X
                RTS
DOWN            DEC CYCLE,X
SCEXIT          RTS

DIRECT          DB  $FF,$00
CYCLE           DB  $04,$04

SDATA           DB  $A8,$85,$80,$80
                DB  $A0,$95,$80,$80
                DB  $80,$D5,$80,$80
                DB  $80,$D4,$82,$80
                DB  $80,$D0,$8A,$80
                DB  $80,$C0,$AA,$80
                DB  $80,$80,$AA,$81
                DB  $80,$80,$A8,$85
                DB  $80,$80,$A0,$95

GUARD_PIC       DB  $0A,$2E,$12,$89
                HEX FE8E1880202028282A95282820EAFE414150505454555565
                HEX 358D655589158B0500E8F2AF00474A721C27299705434971
                HEX 1D0700EEE240409703419D1565394E531497074065390E03
                HEX 00F4D6970539A90A0A02A705444A721C070100F4406070C6
                HEX BF06315515150565390D0C896C3C0F65390E63343597064B
                HEX 9D4070507C200099200099A70B53A850895C5C2A2A7F7FB6
                HEX 6000CF082B0200407097084840701C47711C47711C070101
                HEX 075C70970A689F0C1E7F8B5528009128A70C53AF0C53A600
                HEX 4040535355557F7F8480406078188D7860109950404F8C80
                HEX 1F7555A1656579797C91003E7B000060380E63380E633897
                HEX 0B45970E347C7E7FA5557F2A555400895455A70E53AF0F53
                HEX 9AA70D1D0A0A027F7F8305202A027F8095807F8C2028282A
                HEX 6A2A28282084807F2AC50A40711F970D3A5C67616089781C
                HEX 27713032AD7C2A2A7F552A2A5400542A2AA71053B7115395
                HEX 7F0089505055950501000040407F7F805584A71003824050
                HEX 5455895D9B55555455575F807D75159375052521298D202E
                HEX 03970E386E037014749B831195FF804070543C5C54547450
                HEX 282080FFD5970E51552A8B971254A71255AF12551450A32A
                HEX 994A897272970A85802A84A7120382020A2A2B8B3A9B2B2A
                HEX 8B6A7A803F2F288B0F505455A954555057404F082F289B83
                HEX 0FFF80030E2A3D3A2B2A2F0A150580FF9F10509712659710
                HEX 6AA71456A71556280AA3559952894E4E970C8580055440A7
                HEX 14038801010515155557551515050182807F575595541062
                HEX 3A026A0A2A9100549974715D5175454515554F4CB13F9F13
                HEX 50019F1368A71657A7165F00957E00890A0A2A95970A6302
                HEX 027F7F848002071E188D1E0708990A02728C80782F2A914A
                HEX 729F0D3917141589006A3A3A6E6E3B3B9718346E6E3B3A6E
                HEX 6838266E0E3E3E7EA19715510089971569A71856A7195698
                HEX 05051515558D545050407F7FB607010505970A3E9712314E
                HEX 535C5F955E5D5947455D17775D5D77971A37A71A37745C51
                HEX 754555155555970E5015009115A71A53AF1A53A49716834A
                HEX 4A971285B2406060AF0C3802890A971679A9282B222E0B3B
                HEX 2EAF183597193B2E200F0A3F050099050099A71D53A80A89
                HEX 3B3B971485AA970E40039F0F330300980189058915895595
                HEX 54555157971A341D1D5757559D54545040DE0002070FA483
                HEX 0D42719C8781C0F0FCE7F19C8711B2971782AF1D28282822
                HEX 222AA928E2A47F60971F168DD0010171058D971E359D1515
                HEX 05E0
                DB  $FF
